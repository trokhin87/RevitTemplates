# –ß–∞—Å—Ç—å 1 ‚Äî –ß—Ç–æ —Ç–∞–∫–æ–µ Shared Parameters (–ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ Revit ‚Äî —ç—Ç–æ –±–æ–ª—å—à–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (—Å—Ç–µ–Ω—ã, –¥–≤–µ—Ä–∏, –∫–æ–º–Ω–∞—Ç—ã).
–£ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –µ—Å—Ç—å —Å–≤–æ–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî —Ç–æ, —á—Ç–æ –ø—Ä–∏–¥—É–º–∞–ª Autodesk:

- Room Name

- Room Number

- Area

- Volume

–ù–æ –∏–Ω–æ–≥–¥–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–∏ —Ö–æ—Ç—è—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- ¬´–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–º–µ—â–µ–Ω–∏—è¬ª

- ¬´–í–æ–∑–¥—É—Ö–æ–æ–±–º–µ–Ω¬ª

- ¬´–ö–æ–¥ –ø–æ–º–µ—â–µ–Ω–∏—è¬ª

- ¬´–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ¬ª

–≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç Revit, –Ω–æ –∏–º –Ω—É–∂–Ω–æ –º–µ—Å—Ç–æ, –≥–¥–µ –∏—Ö —Ö—Ä–∞–Ω–∏—Ç—å.

–ü–æ—ç—Ç–æ–º—É –≤ Revit –µ—Å—Ç—å:

üîπ Shared Parameters (–û–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)

–≠—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ:

‚úî –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ª—é–±–æ–º –ø—Ä–æ–µ–∫—Ç–µ
‚úî —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–∞–π–ª–µ .txt
‚úî –º–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ –ª—é–±–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (Rooms, Doors, Walls‚Ä¶)
‚úî –≤–∏–¥–Ω—ã –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ö
‚úî —É—á–∞—Å—Ç–≤—É—é—Ç –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö, —Ç–µ–≥–∞—Ö, —à–∞–±–ª–æ–Ω–∞—Ö

–¢–æ –µ—Å—Ç—å —ç—Ç–æ –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞, –ø–æ–Ω—è—Ç–Ω—ã–µ Revit.

# –ß–∞—Å—Ç—å 2 ‚Äî –û—Ç–∫—É–¥–∞ Revit –±–µ—Ä—ë—Ç —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?

**Revit –Ω–µ –º–æ–∂–µ—Ç —Å–∞–º ¬´–ø—Ä–∏–¥—É–º–∞—Ç—å¬ª –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä.**
–û–Ω –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –ª–µ–∂–∞—Ç—å –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º Shared Parameter File ‚âà –æ–±—ã—á–Ω—ã–π .txt.

–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —Ç–≤–æ–π –∫–æ–¥ –¥–µ–ª–∞–µ—Ç —à–∞–≥:
```
string spPath = Path.Combine(Path.GetTempPath(), "RoomSharedParameters.txt");
CreateSharedParameterFile(spPath);
app.SharedParametersFilename = spPath;
var sharedFile = app.OpenSharedParameterFile();
```

–¢.–µ.:

‚úî –°–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
‚úî Revit ¬´–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è¬ª –∫ –Ω–µ–º—É
‚úî –ò –Ω–∞—á–∏–Ω–∞–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç—É–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
# –ß–∞—Å—Ç—å 3 ‚Äî –ö–∞–∫ Revit —Å–æ–∑–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞

–í —Ç–≤–æ—ë–º –∫–æ–¥–µ:
```
var options = new ExternalDefinitionCreationOptions(name, SpecTypeId.String.Text);
var def = group.Definitions.Create(options);
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

‚û§ –°–æ–∑–¥–∞–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Å –∏–º–µ–Ω–µ–º name
‚û§ –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö ‚Äî String

> –ß—Ç–æ —Ç–∞–∫–æ–µ group?
```
var group = sharedFile.Groups.Create("RoomXML");
```

**Shared –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—Å–µ–≥–¥–∞ –ª–µ–∂–∏—Ç –≤ –≥—Ä—É–ø–ø–µ, –∫–∞–∫ —Ä–∞–∑–¥–µ–ª –≤ .txt.**

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞:
```
*GROUP RoomXML
*PARAM TemperatureGUID  TEXT
*PARAM NameGUID  TEXT
```

Revit —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç GUID‚Äô—ã ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

# –ß–∞—Å—Ç—å 4 ‚Äî –ö–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä ¬´–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è¬ª –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ Rooms

–°–æ–∑–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–≤–∏–Ω–∞ –¥–µ–ª–∞.

–ù–∞–¥–æ –µ—â—ë —Å–∫–∞–∑–∞—Ç—å Revit, –∫ –∫–∞–∫–∏–º –æ–±—ä–µ–∫—Ç–∞–º –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç–Ω–æ—Å–∏—Ç—Å—è.

–í —Ç–≤–æ—ë–º –∫–æ–¥–µ:
```
var roomCat = doc.Settings.Categories.get_Item(BuiltInCategory.OST_Rooms);
var catSet = app.Create.NewCategorySet();
catSet.Insert(roomCat);

var binding = app.Create.NewInstanceBinding(catSet);
doc.ParameterBindings.Insert(def, binding, BuiltInParameterGroup.PG_DATA);
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

‚úî –ù–∞–π—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é Rooms
‚úî –°–æ–∑–¥–∞—Ç—å CategorySet
‚úî –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–≥–æ Rooms
‚úî –ü—Ä–∏–≤—è–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –∫ Room

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:

—É –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä

- –æ–Ω –≤–∏–¥–µ–Ω –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö

- –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∫–æ–¥–æ–º

# –ß–∞—Å—Ç—å 5 ‚Äî –ö–∞–∫ Revit –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ?

–ö–æ–≥–¥–∞ —Ç—ã –≤—ã–ø–æ–ª–Ω—è–µ—à—å:
```
doc.ParameterBindings.Insert(def, binding, BuiltInParameterGroup.PG_DATA);
```

Revit:

- –∫–æ–ø–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ shared-—Ñ–∞–π–ª–∞

- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞ (.rvt)

- –¥–µ–ª–∞–µ—Ç –∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

- –î–∞–∂–µ –µ—Å–ª–∏ —Ç—ã —É–¥–∞–ª–∏—à—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è!

# –ß–∞—Å—Ç—å 6 ‚Äî –ö–∞–∫ —Ç–≤–æ–π ApplyDataCommand –ø–æ—Ç–æ–º –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç–µ–ø–µ—Ä—å —É –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã –µ—Å—Ç—å:

- RUS_Name

- RUS_InternalTemp

- RUS_AirVolumeSupply

‚Ä¶

XML –¥–∞—ë—Ç —Ç–µ–±–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```
<Room>
  <Name>–ü–æ–º–µ—â–µ–Ω–∏–µ 101</Name>
  <InternalTemp>22</InternalTemp>
  <Code>AB-101</Code>
</Room>
```

–ö–æ–¥ –¥–µ–ª–∞–µ—Ç:

- –ó–∞–≥—Ä—É–∂–∞–µ–º XML

- –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º Room ‚Üí —Ç–≤–æ–π RoomModel

- –ò—â–µ–º –≤ –ø—Ä–æ–µ–∫—Ç–µ –∫–æ–º–Ω–∞—Ç—É —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º Code

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ RoomModel –∏—â–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ Revit

- –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Parameter.Set()

–ü—Ä–∏–º–µ—Ä:
```
room.LookupParameter("RUS_InternalTemp").Set(model.InternalTemp);
```
